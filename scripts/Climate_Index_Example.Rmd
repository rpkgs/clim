```{r}
library(Ipaper)

data = climdata_raw
# climdata_raw = fread("data-raw/climdata_raw.csv") %>% unique()
```

## 测试

```{r}
d <- data[year == 1958, ] %>% SpecialValue() 
allIndice(d)
```

> 输入数据需为连续逐日数据，按行排列，允许有空值
> Segment时间段：生长季则为："04-10";水文年则为："04-03";春季则为"03-05";四月则为"04-04",逐月则为"month"
## 1. 年尺度 
```{r}
clim_data <- tidy_input(data, Segment = "01-12")
clim_dataLs <- split(clim_data, clim_data$labels) ## 把数据按照标记label切分成段

# clim_quantile <- clim.quantile(data, ref = c(1961, 1990)) ## 计算降雨和温度的百分位数
AIndice <- lapply(clim_dataLs, allIndice) ## 数据整理成dataframe
AIndice <- do.call(rbind.data.frame, AIndice)

head(AIndice)
# write.xlsx2(AIndice, file = "气候指标.xlsx")
```

## 2. 月尺度
```{r}#
# clim_data <- tidy_input(data, Segment = "month")
# clim_dataLs <- split(clim_data, clim_data$labels) ##把数据按照标记label切分成段#

# clim_quantile <- clim.quantile(data, ref = c(1961, 1990))    ##计算降雨和温度的百分位数
# AIndice <-lapply(clim_dataLs, allIndice)                      ##数据整理成dataframe
# AIndice <- do.call(rbind.data.frame, AIndice)
# head(AIndice)
```
